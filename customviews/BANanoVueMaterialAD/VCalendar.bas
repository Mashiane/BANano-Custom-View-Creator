B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=7
@EndOfDesignText@
#IgnoreWarnings:12
'Custom BANano View class

#Event: Input (argument As Object)

#DesignerProperty: Key: OnInput, DisplayName: OnInput, FieldType: String, DefaultValue: , Description: Event arguments to be passed to the attribute.
#DesignerProperty: Key: Text, DisplayName: Text, FieldType: String, DefaultValue: , Description: Text on the element
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag.
#DesignerProperty: Key: Style, DisplayName: Style, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String.
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String.
#DesignerProperty: Key: Categories, DisplayName: Categories, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: CategoryDays, DisplayName: CategoryDays, FieldType: String, DefaultValue: 1 , Description: 
#DesignerProperty: Key: CategoryForInvalid, DisplayName: CategoryForInvalid, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: CategoryHideDynamic, DisplayName: CategoryHideDynamic, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: CategoryShowAll, DisplayName: CategoryShowAll, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: Dark, DisplayName: Dark, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: DayFormat, DisplayName: DayFormat, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: End, DisplayName: End, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: EventCategory, DisplayName: EventCategory, FieldType: String, DefaultValue: category , Description: 
#DesignerProperty: Key: EventColor, DisplayName: EventColor, FieldType: String, DefaultValue: primary , Description: 
#DesignerProperty: Key: EventEnd, DisplayName: EventEnd, FieldType: String, DefaultValue: end , Description: 
#DesignerProperty: Key: EventHeight, DisplayName: EventHeight, FieldType: String, DefaultValue: 20 , Description: 
#DesignerProperty: Key: EventMarginBottom, DisplayName: EventMarginBottom, FieldType: String, DefaultValue: 1 , Description: 
#DesignerProperty: Key: EventMore, DisplayName: EventMore, FieldType: Boolean, DefaultValue: True , Description: 
#DesignerProperty: Key: EventMoreText, DisplayName: EventMoreText, FieldType: String, DefaultValue: $vuetify.calendar.moreEvents , Description: 
#DesignerProperty: Key: EventName, DisplayName: EventName, FieldType: String, DefaultValue: name , Description: 
#DesignerProperty: Key: EventOverlapMode, DisplayName: EventOverlapMode, FieldType: String, DefaultValue: stack , Description: 
#DesignerProperty: Key: EventOverlapThreshold, DisplayName: EventOverlapThreshold, FieldType: String, DefaultValue: 60 , Description: 
#DesignerProperty: Key: EventRipple, DisplayName: EventRipple, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: EventStart, DisplayName: EventStart, FieldType: String, DefaultValue: start , Description: 
#DesignerProperty: Key: EventTextColor, DisplayName: EventTextColor, FieldType: String, DefaultValue: white , Description: 
#DesignerProperty: Key: EventTimed, DisplayName: EventTimed, FieldType: String, DefaultValue: timed , Description: 

#DesignerProperty: Key: FirstInterval, DisplayName: FirstInterval, FieldType: String, DefaultValue: 0 , Description: 
#DesignerProperty: Key: FirstTime, DisplayName: FirstTime, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: HideHeader, DisplayName: HideHeader, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: IntervalCount, DisplayName: IntervalCount, FieldType: String, DefaultValue: 24 , Description: 
#DesignerProperty: Key: IntervalFormat, DisplayName: IntervalFormat, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: IntervalHeight, DisplayName: IntervalHeight, FieldType: String, DefaultValue: 48 , Description: 
#DesignerProperty: Key: IntervalMinutes, DisplayName: IntervalMinutes, FieldType: String, DefaultValue: 60 , Description: 
#DesignerProperty: Key: IntervalStyle, DisplayName: IntervalStyle, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: IntervalWidth, DisplayName: IntervalWidth, FieldType: String, DefaultValue: 60 , Description: 
#DesignerProperty: Key: Key, DisplayName: Key, FieldType: String, DefaultValue:  , Description: key
#DesignerProperty: Key: Light, DisplayName: Light, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: Locale, DisplayName: Locale, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: LocaleFirstDayOfYear, DisplayName: LocaleFirstDayOfYear, FieldType: String, DefaultValue: 0 , Description: 
#DesignerProperty: Key: MaxDays, DisplayName: MaxDays, FieldType: String, DefaultValue: 7 , Description: 
#DesignerProperty: Key: MinWeeks, DisplayName: MinWeeks, FieldType: String, DefaultValue: 1 , Description: 
#DesignerProperty: Key: MonthFormat, DisplayName: MonthFormat, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: Now, DisplayName: Now, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: ParentId, DisplayName: ParentId, FieldType: String, DefaultValue:  , Description: parent-id
#DesignerProperty: Key: Ref, DisplayName: Ref, FieldType: String, DefaultValue:  , Description: ref
#DesignerProperty: Key: ShortIntervals, DisplayName: ShortIntervals, FieldType: Boolean, DefaultValue: True , Description: 
#DesignerProperty: Key: ShortMonths, DisplayName: ShortMonths, FieldType: Boolean, DefaultValue: True , Description: 
#DesignerProperty: Key: ShortWeekdays, DisplayName: ShortWeekdays, FieldType: Boolean, DefaultValue: True , Description: 
#DesignerProperty: Key: ShowIntervalLabel, DisplayName: ShowIntervalLabel, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: ShowMonthOnFirst, DisplayName: ShowMonthOnFirst, FieldType: Boolean, DefaultValue: True , Description: 
#DesignerProperty: Key: ShowWeek, DisplayName: ShowWeek, FieldType: Boolean, DefaultValue: False , Description: 
#DesignerProperty: Key: Start, DisplayName: Start, FieldType: String, DefaultValue: 2020-08-06 , Description: 
#DesignerProperty: Key: Type, DisplayName: Type, FieldType: String, DefaultValue: month , Description: 
#DesignerProperty: Key: VBindClass, DisplayName: VBindClass, FieldType: String, DefaultValue:  , Description: v-bind:class
#DesignerProperty: Key: VBindStyle, DisplayName: VBindStyle, FieldType: String, DefaultValue:  , Description: v-bind:style
#DesignerProperty: Key: VElse, DisplayName: VElse, FieldType: String, DefaultValue:  , Description: v-else
#DesignerProperty: Key: VElseIf, DisplayName: VElseIf, FieldType: String, DefaultValue:  , Description: v-else-if
#DesignerProperty: Key: VFor, DisplayName: VFor, FieldType: String, DefaultValue:  , Description: v-for
#DesignerProperty: Key: VHtml, DisplayName: VHtml, FieldType: String, DefaultValue:  , Description: v-html
#DesignerProperty: Key: VIf, DisplayName: VIf, FieldType: String, DefaultValue:  , Description: v-if
#DesignerProperty: Key: VModel, DisplayName: VModel, FieldType: String, DefaultValue:  , Description: v-model
#DesignerProperty: Key: VOn, DisplayName: VOn, FieldType: String, DefaultValue:  , Description: v-on
#DesignerProperty: Key: VShow, DisplayName: VShow, FieldType: String, DefaultValue:  , Description: v-show
#DesignerProperty: Key: VText, DisplayName: VText, FieldType: String, DefaultValue:  , Description: v-text
#DesignerProperty: Key: Value, DisplayName: Value, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: WeekdayFormat, DisplayName: WeekdayFormat, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: Weekdays, DisplayName: Weekdays, FieldType: String, DefaultValue:  , Description: 
#DesignerProperty: Key: BorderColor, DisplayName: BorderColor, FieldType: String, DefaultValue:  , Description: null, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: BorderRadius, DisplayName: BorderRadius, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: BorderStyle, DisplayName: BorderStyle, FieldType: String, DefaultValue:  , Description: null, List: dashed|dotted|double|groove|hidden|inset|none|outset|ridge|solid
#DesignerProperty: Key: BorderWidth, DisplayName: BorderWidth, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: MarginBottom, DisplayName: MarginBottom, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: MarginLeft, DisplayName: MarginLeft, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: MarginRight, DisplayName: MarginRight, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: MarginTop, DisplayName: MarginTop, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: PaddingBottom, DisplayName: PaddingBottom, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: PaddingLeft, DisplayName: PaddingLeft, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: PaddingRight, DisplayName: PaddingRight, FieldType: String, DefaultValue:  , Description: null
#DesignerProperty: Key: PaddingTop, DisplayName: PaddingTop, FieldType: String, DefaultValue:  , Description: null

Sub Class_Globals
Private BANano As BANano 'ignore
Private mName As String 'ignore
Private mEventName As String 'ignore
Private mCallBack As Object 'ignore
Private mTarget As BANanoElement 'ignore
Private mElement As BANanoElement 'ignore
Private mClasses As String = ""
Private mStyle As String = ""
Private mAttributes As String = ""
Private mText As String = ""
Private classList As Map
Private styleList As Map
Private attributeList As Map
Private mTagName As String = "v-calendar"
Private sbText As StringBuilder
Public bindings As Map
Public methods As Map
Private eOnInput As String = ""
Private mCategories As String = ""
Private mCategoryDays As String = "1"
Private mCategoryForInvalid As String = ""
Private mCategoryHideDynamic As Boolean = False
Private mCategoryShowAll As Boolean = False
Private mColor As String = ""
Private mDark As Boolean = False
Private mDayFormat As String = ""
Private mEnd As String = ""
Private mEventCategory As String = "category"
Private mEventColor As String = "primary"
Private mEventEnd As String = "end"
Private mEventHeight As String = "20"
Private mEventMarginBottom As String = "1"
Private mEventMore As Boolean = True
Private mEventMoreText As String = "$vuetify.calendar.moreEvents"
Private mEventName As String = "name"
Private mEventOverlapMode As String = "stack"
Private mEventOverlapThreshold As String = "60"
Private mEventRipple As String = ""
Private mEventStart As String = "start"
Private mEventTextColor As String = "white"
Private mEventTimed As String = "timed"
Private mEvents As List
Private mFirstInterval As String = "0"
Private mFirstTime As String = ""
Private mHideHeader As Boolean = False
Private mIntervalCount As String = "24"
Private mIntervalFormat As String = ""
Private mIntervalHeight As String = "48"
Private mIntervalMinutes As String = "60"
Private mIntervalStyle As String = ""
Private mIntervalWidth As String = "60"
Private mKey As String = ""
Private mLight As Boolean = False
Private mLocale As String = ""
Private mLocaleFirstDayOfYear As String = "0"
Private mMaxDays As String = "7"
Private mMinWeeks As String = "1"
Private mMonthFormat As String = ""
Private mNow As String = ""
Private mParentId As String = ""
Private mRef As String = ""
Private mShortIntervals As Boolean = True
Private mShortMonths As Boolean = True
Private mShortWeekdays As Boolean = True
Private mShowIntervalLabel As String = ""
Private mShowMonthOnFirst As Boolean = True
Private mShowWeek As Boolean = False
Private mStart As String = "2020-08-06"
Private mType As String = "month"
Private mVBindClass As String = ""
Private mVBindStyle As String = ""
Private mVElse As String = ""
Private mVElseIf As String = ""
Private mVFor As String = ""
Private mVHtml As String = ""
Private mVIf As String = ""
Private mVModel As String = ""
Private mVOn As String = ""
Private mVShow As String = ""
Private mVText As String = ""
Private mValue As String = ""
Private mWeekdayFormat As String = ""
Private mWeekdays As String = ""
Private mBorderColor As String = ""
Private mBorderRadius As String = ""
Private mBorderStyle As String = ""
Private mBorderWidth As String = ""
Private mMarginBottom As String = ""
Private mMarginLeft As String = ""
Private mMarginRight As String = ""
Private mMarginTop As String = ""
Private mPaddingBottom As String = ""
Private mPaddingLeft As String = ""
Private mPaddingRight As String = ""
Private mPaddingTop As String = ""
End Sub

'initialize the custom view
Public Sub Initialize (CallBack As Object, Name As String, EventName As String)
mName = Name.ToLowerCase
mEventName = EventName.ToLowerCase
mCallBack = CallBack
classList.Initialize
styleList.Initialize
attributeList.Initialize
sbText.Initialize
bindings.Initialize
methods.Initialize
End Sub

'Create view in the designer
Public Sub DesignerCreateView (Target As BANanoElement, Props As Map)
mTarget = Target
If Props <> Null Then
mClasses = Props.Get("Classes")
mAttributes = Props.Get("Attributes")
mStyle = Props.Get("Style")
mText = Props.Get("Text")
eOnInput = Props.Get("OnInput")
mCategories = Props.Get("Categories")
mCategoryDays = Props.Get("CategoryDays")
mCategoryForInvalid = Props.Get("CategoryForInvalid")
mCategoryHideDynamic = Props.Get("CategoryHideDynamic")
mCategoryShowAll = Props.Get("CategoryShowAll")
mColor = Props.Get("Color")
mDark = Props.Get("Dark")
mDayFormat = Props.Get("DayFormat")
mEnd = Props.Get("End")
mEventCategory = Props.Get("EventCategory")
mEventColor = Props.Get("EventColor")
mEventEnd = Props.Get("EventEnd")
mEventHeight = Props.Get("EventHeight")
mEventMarginBottom = Props.Get("EventMarginBottom")
mEventMore = Props.Get("EventMore")
mEventMoreText = Props.Get("EventMoreText")
mEventName = Props.Get("EventName")
mEventOverlapMode = Props.Get("EventOverlapMode")
mEventOverlapThreshold = Props.Get("EventOverlapThreshold")
mEventRipple = Props.Get("EventRipple")
mEventStart = Props.Get("EventStart")
mEventTextColor = Props.Get("EventTextColor")
mEventTimed = Props.Get("EventTimed")
mFirstInterval = Props.Get("FirstInterval")
mFirstTime = Props.Get("FirstTime")
mHideHeader = Props.Get("HideHeader")
mIntervalCount = Props.Get("IntervalCount")
mIntervalFormat = Props.Get("IntervalFormat")
mIntervalHeight = Props.Get("IntervalHeight")
mIntervalMinutes = Props.Get("IntervalMinutes")
mIntervalStyle = Props.Get("IntervalStyle")
mIntervalWidth = Props.Get("IntervalWidth")
mKey = Props.Get("Key")
mLight = Props.Get("Light")
mLocale = Props.Get("Locale")
mLocaleFirstDayOfYear = Props.Get("LocaleFirstDayOfYear")
mMaxDays = Props.Get("MaxDays")
mMinWeeks = Props.Get("MinWeeks")
mMonthFormat = Props.Get("MonthFormat")
mNow = Props.Get("Now")
mParentId = Props.Get("ParentId")
mRef = Props.Get("Ref")
mShortIntervals = Props.Get("ShortIntervals")
mShortMonths = Props.Get("ShortMonths")
mShortWeekdays = Props.Get("ShortWeekdays")
mShowIntervalLabel = Props.Get("ShowIntervalLabel")
mShowMonthOnFirst = Props.Get("ShowMonthOnFirst")
mShowWeek = Props.Get("ShowWeek")
mStart = Props.Get("Start")
mType = Props.Get("Type")
mVBindClass = Props.Get("VBindClass")
mVBindStyle = Props.Get("VBindStyle")
mVElse = Props.Get("VElse")
mVElseIf = Props.Get("VElseIf")
mVFor = Props.Get("VFor")
mVHtml = Props.Get("VHtml")
mVIf = Props.Get("VIf")
mVModel = Props.Get("VModel")
mVOn = Props.Get("VOn")
mVShow = Props.Get("VShow")
mVText = Props.Get("VText")
mValue = Props.Get("Value")
mWeekdayFormat = Props.Get("WeekdayFormat")
mWeekdays = Props.Get("Weekdays")
mBorderColor = Props.Get("BorderColor")
mBorderRadius = Props.Get("BorderRadius")
mBorderStyle = Props.Get("BorderStyle")
mBorderWidth = Props.Get("BorderWidth")
mMarginBottom = Props.Get("MarginBottom")
mMarginLeft = Props.Get("MarginLeft")
mMarginRight = Props.Get("MarginRight")
mMarginTop = Props.Get("MarginTop")
mPaddingBottom = Props.Get("PaddingBottom")
mPaddingLeft = Props.Get("PaddingLeft")
mPaddingRight = Props.Get("PaddingRight")
mPaddingTop = Props.Get("PaddingTop")
End If

AddAttr("categories", mCategories)
AddAttr("category-days", mCategoryDays)
AddAttr("category-for-invalid", mCategoryForInvalid)
AddAttr("category-hide-dynamic", mCategoryHideDynamic)
AddAttr("category-show-all", mCategoryShowAll)
AddAttr("color", mColor)
AddAttr("dark", mDark)
AddAttr("day-format", mDayFormat)
AddAttr("end", mEnd)
AddAttr("event-category", mEventCategory)
AddAttr("event-color", mEventColor)
AddAttr("event-end", mEventEnd)
AddAttr("event-height", mEventHeight)
AddAttr("event-margin-bottom", mEventMarginBottom)
AddAttr("event-more", mEventMore)
AddAttr("event-more-text", mEventMoreText)
AddAttr("event-name", mEventName)
AddAttr("event-overlap-mode", mEventOverlapMode)
AddAttr("event-overlap-threshold", mEventOverlapThreshold)
AddAttr("event-ripple", mEventRipple)
AddAttr("event-start", mEventStart)
AddAttr("event-text-color", mEventTextColor)
AddAttr("event-timed", mEventTimed)
AddAttr("events", mEvents)
AddAttr("first-interval", mFirstInterval)
AddAttr("first-time", mFirstTime)
AddAttr("hide-header", mHideHeader)
AddAttr("interval-count", mIntervalCount)
AddAttr("interval-format", mIntervalFormat)
AddAttr("interval-height", mIntervalHeight)
AddAttr("interval-minutes", mIntervalMinutes)
AddAttr("interval-style", mIntervalStyle)
AddAttr("interval-width", mIntervalWidth)
AddAttr("key", mKey)
AddAttr("light", mLight)
AddAttr("locale", mLocale)
AddAttr("locale-first-day-of-year", mLocaleFirstDayOfYear)
AddAttr("max-days", mMaxDays)
AddAttr("min-weeks", mMinWeeks)
AddAttr("month-format", mMonthFormat)
AddAttr("now", mNow)
AddAttr("parent-id", mParentId)
AddAttr("ref", mRef)
AddAttr("short-intervals", mShortIntervals)
AddAttr("short-months", mShortMonths)
AddAttr("short-weekdays", mShortWeekdays)
AddAttr("show-interval-label", mShowIntervalLabel)
AddAttr("show-month-on-first", mShowMonthOnFirst)
AddAttr("show-week", mShowWeek)
AddAttr("start", mStart)
AddAttr("type", mType)
AddAttr("v-bind:class", mVBindClass)
AddAttr("v-bind:style", mVBindStyle)
AddAttr("v-else", mVElse)
AddAttr("v-else-if", mVElseIf)
AddAttr("v-for", mVFor)
AddAttr("v-html", mVHtml)
AddAttr("v-if", mVIf)
AddAttr("v-model", mVModel)
AddAttr("v-on", mVOn)
AddAttr("v-show", mVShow)
AddAttr("v-text", mVText)
AddAttr("value", mValue)
AddAttr("weekday-format", mWeekdayFormat)
AddAttr("weekdays", mWeekdays)
AddStyle("border-color", mBorderColor)
AddStyle("border-radius", mBorderRadius)
AddStyle("border-style", mBorderStyle)
AddStyle("border-width", mBorderWidth)
AddStyle("margin-bottom", mMarginBottom)
AddStyle("margin-left", mMarginLeft)
AddStyle("margin-right", mMarginRight)
AddStyle("margin-top", mMarginTop)
AddStyle("padding-bottom", mPaddingBottom)
AddStyle("padding-left", mPaddingLeft)
AddStyle("padding-right", mPaddingRight)
AddStyle("padding-top", mPaddingTop)
AddClass(mClasses)
setAttributes(mAttributes)
setStyles(mStyle)

'build and get the element
Dim strHTML As String = ToString
mElement = mTarget.Append(strHTML).Get("#" & mName)
'add events for the custom view, if any
'This activates Input the event exists on the module
SetOnInput

End Sub

'return the generated html
Sub ToString As String
'build the 'class' attribute
Dim className As String = BANanoShared.JoinMapKeys(classList, " ")
AddAttr("class", className)
'build the 'style' attribute
Dim styleName As String = BANanoShared.BuildStyle(styleList)
AddAttr("style", styleName)
'build element internal structure
Dim iStructure As String = BANanoShared.BuildAttributes(attributeList)
Dim rslt As String = $"<${mTagName} id="${mName}" ${iStructure}>${mText}${sbText.ToString}</${mTagName}>"$
Return rslt
End Sub

'bind an attribute
Sub SetVBind(prop As String, value As String)
prop = prop.ToLowerCase
value = value.ToLowerCase
prop = $"v-bind:${prop}"$
AddAttr(prop,value)
bindings.Put(value, Null)
End Sub

'add component to app, this binds events and states
Sub AddToApp(vap As VueApp)
'apply the binding for the control
For Each k As String In bindings.Keys
Dim v As String = bindings.Get(k)
vap.SetData(k, v)
Next
'apply the events
For Each k As String In methods.Keys
Dim cb As BANanoObject = methods.Get(k)
vap.SetCallBack(k, cb)
Next
End Sub

'add component to another, this binds events and states
Sub AddToComponent(ve As VMElement)
'apply the binding for the control
For Each k As String In bindings.Keys
Dim v As String = bindings.Get(k)
ve.SetData(k, v)
Next
'apply the events
For Each k As String In methods.Keys
Dim cb As BANanoObject = methods.Get(k)
ve.SetCallBack(k, cb)
Next
End Sub

'add a break
Sub AddBR
sbText.Append("<br>")
End Sub

'add a horizontal rule
Sub AddHR
sbText.Append("<hr>")
End Sub

'add an element to the text
Sub AddElement(elID As String, tag As String, props As Map, styleProps As Map, classNames As List, loose As List, Text As String)
elID = elID.tolowercase
elID = elID.Replace("#","")
Dim elIT As VHTML
elIT.Initialize(mCallBack, elID, elID)
elIT.SetText(Text)
elIT.SetTagName(tag)
If loose <> Null Then
For Each k As String In loose
elIT.SetAttr(k, True)
Next
End If
If props <> Null Then
For Each k As String In props.Keys
Dim v As String = props.Get(k)
elIT.SetAttr(k, v)
Next
End If
If styleProps <> Null Then
For Each k As String In styleProps.Keys
Dim v As String = styleProps.Get(k)
elIT.SetAttr(k, v)
Next
End If
If classNames <> Null Then
elIT.AddClass(classNames)
End If
'convert to string
Dim sElement As String = elIT.tostring
sbText.Append(sElement)
End Sub

'returns the BANanoElement
public Sub getElement() As BANanoElement
Return mElement
End Sub

'returns the tag id
public Sub getID() As String
Return mName
End Sub

'add the element to the parent
public Sub AddToParent(targetID As String)
mTarget = BANano.GetElement("#" & targetID.ToLowerCase)
DesignerCreateView(mTarget, Null)
End Sub

'remove the component
public Sub Remove()
mElement.Remove
BANano.SetMeToNull
End Sub

'trigger an event
public Sub Trigger(event As String, params() As String)
If mElement <> Null Then
mElement.Trigger(event, params)
End If
End Sub

'add a class
public Sub AddClass(varClass As String)
If BANano.IsUndefined(varClass) Or BANano.IsNull(varClass) Then Return
If BANano.IsNumber(varClass) Then varClass = BANanoShared.CStr(varClass)
varClass = varClass.trim
if varClass = "" Then Return
If mElement <> Null Then mElement.AddClass(varClass)
Dim mxItems As List = BANanoShared.StrParse(" ", varClass)
For Each mt As String In mxItems
classList.put(mt, mt)
Next
End Sub

'add a class on condition
public Sub AddClassOnCondition(varClass As String, varCondition As Boolean, varShouldBe As boolean)
If BANano.IsUndefined(varCondition) Or BANano.IsNull(varCondition) Then Return
if varShouldBe <> varCondition Then Return
If BANano.IsUndefined(varClass) Or BANano.IsNull(varClass) Then Return
If BANano.IsNumber(varClass) Then varClass = BANanoShared.CStr(varClass)
varClass = varClass.trim
if varClass = "" Then Return
If mElement <> Null Then mElement.AddClass(varClass)
Dim mxItems As List = BANanoShared.StrParse(" ", varClass)
For Each mt As String In mxItems
classList.put(mt, mt)
Next
End Sub

'add a style
public Sub AddStyle(varProp As string, varStyle As String)
If BANano.IsUndefined(varStyle) Or BANano.IsNull(varStyle) Then Return
If BANano.IsNumber(varStyle) Then varStyle = BANanoShared.CStr(varStyle)
If mElement <> Null Then
Dim aStyle As Map = CreateMap()
aStyle.put(varProp, varStyle)
Dim sStyle As String = BANano.ToJSON(aStyle)
mElement.SetStyle(sStyle)
End If
styleList.put(varProp, varStyle)
End Sub

'add an attribute
Public Sub AddAttr(varProp As String, varValue As String) 
If BANano.IsUndefined(varValue) Or BANano.IsNull(varValue) Then Return 
If BANano.IsNumber(varValue) Then varValue = BANanoShared.CStr(varValue) 
'we are adding a boolean 
If BANano.IsBoolean(varValue) Then 
If varValue = True Then  
attributeList.put(varProp, varValue) 
If mElement <> Null Then mElement.SetAttr(varProp, varValue) 
End If 
Else 
'we are adding a string 
If varValue.StartsWith(":") Then 
If varValue.StartsWith("$") Then 
attributeList.put(varProp, varValue) 
If mElement <> Null Then mElement.SetAttr(varProp, varValue) 
Else 
Dim rname As String = BANanoShared.MidString2(varValue, 2) 
If rname.Contains(".") = False Then bindings.Put(rname, Null) 
attributeList.put($":${varProp}"$, rname) 
If mElement <> Null Then mElement.SetAttr($":${varProp}"$, rname) 
End If 
Else 
'does not start with : 
If mElement <> Null Then mElement.SetAttr(varProp, varValue) 
attributeList.put(varProp, varValue) 
Select Case varProp 
Case "v-model", "v-show", "v-if", "required", "disabled", "readonly" 
bindings.Put(varValue, Null) 
End Select 
End If 
End If 
Return 
End Sub

'returns the class names
Public Sub getClasses() As String
Dim sbClass As StringBuilder
sbClass.Initialize
For each k As String in classList.Keys
sbClass.Append(k).Append(" ")
Next
mClasses = sbClass.ToString
Return mClasses
End Sub

'set the style use a valid JSON string with {}
public Sub setStyle(varStyle As String)
If mElement <> Null Then
mElement.SetStyle(varStyle)
End If
Dim mres as Map = BANano.FromJSON(varStyle)
For each k As String in mres.Keys
Dim v As String = mres.Get(k)
styleList.put(k, v)
Next
End Sub

'returns the style as JSON
public Sub getStyle() As String
Dim sbStyle As StringBuilder
sbStyle.Initialize
sbStyle.Append("{")
For each k As String in styleList.Keys
Dim v As String = styleList.Get(k)
sbStyle.Append(k).Append(":").Append(v).Append(",")
Next
sbStyle.Append("}")
mStyle = sbStyle.ToString
Return mStyle
End Sub

'sets the attributes
public Sub setAttributes(varAttributes As String)
Dim mxItems As List = BANanoShared.StrParse(";", varAttributes)
For Each mt As String In mxItems
Dim k As String = BANanoShared.MvField(mt,1,"=")
Dim v As String = BANanoShared.MvField(mt,2,"=")
If mElement <> Null Then mElement.SetAttr(k, v)
attributeList.put(k, v)
Next
End Sub

'sets the styles from the designer
public Sub setStyles(varStyles As String)
Dim mxItems As List = BANanoShared.StrParse(",", varStyles)
For Each mt As String In mxItems
Dim k As String = BANanoShared.MvField(mt,1,":")
Dim v As String = BANanoShared.MvField(mt,2,":")
AddStyle(k, v)
Next
End Sub

'returns the attributes
public Sub getAttributes() As String
Dim sbAttr As StringBuilder
sbAttr.Initialize
For each k As String in attributeList.Keys
Dim v As String = attributeList.Get(k)
sbAttr.Append(k).Append("=").Append(v).Append(";")
Next
mAttributes = sbAttr.ToString
Return mAttributes
End Sub

'sets the text
public Sub setText(varText As String)
If mElement <> Null Then
mElement.SetHTML(BANano.SF(varText))
End If
mText = varText
End Sub

'returns the text
public Sub getText() As String
Return mText
End Sub

public Sub setCategories(varCategories As String)
AddAttr("categories", varCategories)
mCategories = varCategories
End Sub

public Sub getCategories() As String
Return mCategories
End Sub

public Sub setCategoryDays(varCategoryDays As String)
AddAttr("category-days", varCategoryDays)
mCategoryDays = varCategoryDays
End Sub

public Sub getCategoryDays() As String
Return mCategoryDays
End Sub

public Sub setCategoryForInvalid(varCategoryForInvalid As String)
AddAttr("category-for-invalid", varCategoryForInvalid)
mCategoryForInvalid = varCategoryForInvalid
End Sub

public Sub getCategoryForInvalid() As String
Return mCategoryForInvalid
End Sub

public Sub setCategoryHideDynamic(varCategoryHideDynamic As Boolean)
AddAttr("category-hide-dynamic", varCategoryHideDynamic)
mCategoryHideDynamic = varCategoryHideDynamic
End Sub

public Sub getCategoryHideDynamic() As Boolean
Return mCategoryHideDynamic
End Sub

public Sub setCategoryShowAll(varCategoryShowAll As Boolean)
AddAttr("category-show-all", varCategoryShowAll)
mCategoryShowAll = varCategoryShowAll
End Sub

public Sub getCategoryShowAll() As Boolean
Return mCategoryShowAll
End Sub

public Sub setColor(varColor As String)
AddAttr("color", varColor)
mColor = varColor
End Sub

public Sub getColor() As String
Return mColor
End Sub

public Sub setDark(varDark As Boolean)
AddAttr("dark", varDark)
mDark = varDark
End Sub

public Sub getDark() As Boolean
Return mDark
End Sub

public Sub setDayFormat(varDayFormat As String)
AddAttr("day-format", varDayFormat)
mDayFormat = varDayFormat
End Sub

public Sub getDayFormat() As String
Return mDayFormat
End Sub

public Sub setEnd(varEnd As String)
AddAttr("end", varEnd)
mEnd = varEnd
End Sub

public Sub getEnd() As String
Return mEnd
End Sub

public Sub setEventCategory(varEventCategory As String)
AddAttr("event-category", varEventCategory)
mEventCategory = varEventCategory
End Sub

public Sub getEventCategory() As String
Return mEventCategory
End Sub

public Sub setEventColor(varEventColor As String)
AddAttr("event-color", varEventColor)
mEventColor = varEventColor
End Sub

public Sub getEventColor() As String
Return mEventColor
End Sub

public Sub setEventEnd(varEventEnd As String)
AddAttr("event-end", varEventEnd)
mEventEnd = varEventEnd
End Sub

public Sub getEventEnd() As String
Return mEventEnd
End Sub

public Sub setEventHeight(varEventHeight As String)
AddAttr("event-height", varEventHeight)
mEventHeight = varEventHeight
End Sub

public Sub getEventHeight() As String
Return mEventHeight
End Sub

public Sub setEventMarginBottom(varEventMarginBottom As String)
AddAttr("event-margin-bottom", varEventMarginBottom)
mEventMarginBottom = varEventMarginBottom
End Sub

public Sub getEventMarginBottom() As String
Return mEventMarginBottom
End Sub

public Sub setEventMore(varEventMore As Boolean)
AddAttr("event-more", varEventMore)
mEventMore = varEventMore
End Sub

public Sub getEventMore() As Boolean
Return mEventMore
End Sub

public Sub setEventMoreText(varEventMoreText As String)
AddAttr("event-more-text", varEventMoreText)
mEventMoreText = varEventMoreText
End Sub

public Sub getEventMoreText() As String
Return mEventMoreText
End Sub

public Sub setEventName(varEventName As String)
AddAttr("event-name", varEventName)
mEventName = varEventName
End Sub

public Sub getEventName() As String
Return mEventName
End Sub

public Sub setEventOverlapMode(varEventOverlapMode As String)
AddAttr("event-overlap-mode", varEventOverlapMode)
mEventOverlapMode = varEventOverlapMode
End Sub

public Sub getEventOverlapMode() As String
Return mEventOverlapMode
End Sub

public Sub setEventOverlapThreshold(varEventOverlapThreshold As String)
AddAttr("event-overlap-threshold", varEventOverlapThreshold)
mEventOverlapThreshold = varEventOverlapThreshold
End Sub

public Sub getEventOverlapThreshold() As String
Return mEventOverlapThreshold
End Sub

public Sub setEventRipple(varEventRipple As String)
AddAttr("event-ripple", varEventRipple)
mEventRipple = varEventRipple
End Sub

public Sub getEventRipple() As String
Return mEventRipple
End Sub

public Sub setEventStart(varEventStart As String)
AddAttr("event-start", varEventStart)
mEventStart = varEventStart
End Sub

public Sub getEventStart() As String
Return mEventStart
End Sub

public Sub setEventTextColor(varEventTextColor As String)
AddAttr("event-text-color", varEventTextColor)
mEventTextColor = varEventTextColor
End Sub

public Sub getEventTextColor() As String
Return mEventTextColor
End Sub

public Sub setEventTimed(varEventTimed As String)
AddAttr("event-timed", varEventTimed)
mEventTimed = varEventTimed
End Sub

public Sub getEventTimed() As String
Return mEventTimed
End Sub

public Sub setEvents(varEvents As List)
AddAttr("events", varEvents)
mEvents = varEvents
End Sub

public Sub getEvents() As List
Return mEvents
End Sub

public Sub setFirstInterval(varFirstInterval As String)
AddAttr("first-interval", varFirstInterval)
mFirstInterval = varFirstInterval
End Sub

public Sub getFirstInterval() As String
Return mFirstInterval
End Sub

public Sub setFirstTime(varFirstTime As String)
AddAttr("first-time", varFirstTime)
mFirstTime = varFirstTime
End Sub

public Sub getFirstTime() As String
Return mFirstTime
End Sub

public Sub setHideHeader(varHideHeader As Boolean)
AddAttr("hide-header", varHideHeader)
mHideHeader = varHideHeader
End Sub

public Sub getHideHeader() As Boolean
Return mHideHeader
End Sub

public Sub setIntervalCount(varIntervalCount As String)
AddAttr("interval-count", varIntervalCount)
mIntervalCount = varIntervalCount
End Sub

public Sub getIntervalCount() As String
Return mIntervalCount
End Sub

public Sub setIntervalFormat(varIntervalFormat As String)
AddAttr("interval-format", varIntervalFormat)
mIntervalFormat = varIntervalFormat
End Sub

public Sub getIntervalFormat() As String
Return mIntervalFormat
End Sub

public Sub setIntervalHeight(varIntervalHeight As String)
AddAttr("interval-height", varIntervalHeight)
mIntervalHeight = varIntervalHeight
End Sub

public Sub getIntervalHeight() As String
Return mIntervalHeight
End Sub

public Sub setIntervalMinutes(varIntervalMinutes As String)
AddAttr("interval-minutes", varIntervalMinutes)
mIntervalMinutes = varIntervalMinutes
End Sub

public Sub getIntervalMinutes() As String
Return mIntervalMinutes
End Sub

public Sub setIntervalStyle(varIntervalStyle As String)
AddAttr("interval-style", varIntervalStyle)
mIntervalStyle = varIntervalStyle
End Sub

public Sub getIntervalStyle() As String
Return mIntervalStyle
End Sub

public Sub setIntervalWidth(varIntervalWidth As String)
AddAttr("interval-width", varIntervalWidth)
mIntervalWidth = varIntervalWidth
End Sub

public Sub getIntervalWidth() As String
Return mIntervalWidth
End Sub

'set key
public Sub setKey(varKey As String)
AddAttr("key", varKey)
mKey = varKey
End Sub

'get key
public Sub getKey() As String
Return mKey
End Sub

public Sub setLight(varLight As Boolean)
AddAttr("light", varLight)
mLight = varLight
End Sub

public Sub getLight() As Boolean
Return mLight
End Sub

public Sub setLocale(varLocale As String)
AddAttr("locale", varLocale)
mLocale = varLocale
End Sub

public Sub getLocale() As String
Return mLocale
End Sub

public Sub setLocaleFirstDayOfYear(varLocaleFirstDayOfYear As String)
AddAttr("locale-first-day-of-year", varLocaleFirstDayOfYear)
mLocaleFirstDayOfYear = varLocaleFirstDayOfYear
End Sub

public Sub getLocaleFirstDayOfYear() As String
Return mLocaleFirstDayOfYear
End Sub

public Sub setMaxDays(varMaxDays As String)
AddAttr("max-days", varMaxDays)
mMaxDays = varMaxDays
End Sub

public Sub getMaxDays() As String
Return mMaxDays
End Sub

public Sub setMinWeeks(varMinWeeks As String)
AddAttr("min-weeks", varMinWeeks)
mMinWeeks = varMinWeeks
End Sub

public Sub getMinWeeks() As String
Return mMinWeeks
End Sub

public Sub setMonthFormat(varMonthFormat As String)
AddAttr("month-format", varMonthFormat)
mMonthFormat = varMonthFormat
End Sub

public Sub getMonthFormat() As String
Return mMonthFormat
End Sub

public Sub setNow(varNow As String)
AddAttr("now", varNow)
mNow = varNow
End Sub

public Sub getNow() As String
Return mNow
End Sub

'set parent-id
public Sub setParentId(varParentId As String)
AddAttr("parent-id", varParentId)
mParentId = varParentId
End Sub

'get parent-id
public Sub getParentId() As String
Return mParentId
End Sub

'set ref
public Sub setRef(varRef As String)
AddAttr("ref", varRef)
mRef = varRef
End Sub

'get ref
public Sub getRef() As String
Return mRef
End Sub

public Sub setShortIntervals(varShortIntervals As Boolean)
AddAttr("short-intervals", varShortIntervals)
mShortIntervals = varShortIntervals
End Sub

public Sub getShortIntervals() As Boolean
Return mShortIntervals
End Sub

public Sub setShortMonths(varShortMonths As Boolean)
AddAttr("short-months", varShortMonths)
mShortMonths = varShortMonths
End Sub

public Sub getShortMonths() As Boolean
Return mShortMonths
End Sub

public Sub setShortWeekdays(varShortWeekdays As Boolean)
AddAttr("short-weekdays", varShortWeekdays)
mShortWeekdays = varShortWeekdays
End Sub

public Sub getShortWeekdays() As Boolean
Return mShortWeekdays
End Sub

public Sub setShowIntervalLabel(varShowIntervalLabel As String)
AddAttr("show-interval-label", varShowIntervalLabel)
mShowIntervalLabel = varShowIntervalLabel
End Sub

public Sub getShowIntervalLabel() As String
Return mShowIntervalLabel
End Sub

public Sub setShowMonthOnFirst(varShowMonthOnFirst As Boolean)
AddAttr("show-month-on-first", varShowMonthOnFirst)
mShowMonthOnFirst = varShowMonthOnFirst
End Sub

public Sub getShowMonthOnFirst() As Boolean
Return mShowMonthOnFirst
End Sub

public Sub setShowWeek(varShowWeek As Boolean)
AddAttr("show-week", varShowWeek)
mShowWeek = varShowWeek
End Sub

public Sub getShowWeek() As Boolean
Return mShowWeek
End Sub

public Sub setStart(varStart As String)
AddAttr("start", varStart)
mStart = varStart
End Sub

public Sub getStart() As String
Return mStart
End Sub

public Sub setType(varType As String)
AddAttr("type", varType)
mType = varType
End Sub

public Sub getType() As String
Return mType
End Sub

'set v-bind:class
public Sub setVBindClass(varVBindClass As String)
AddAttr("v-bind:class", varVBindClass)
mVBindClass = varVBindClass
End Sub

'get v-bind:class
public Sub getVBindClass() As String
Return mVBindClass
End Sub

'set v-bind:style
public Sub setVBindStyle(varVBindStyle As String)
AddAttr("v-bind:style", varVBindStyle)
mVBindStyle = varVBindStyle
End Sub

'get v-bind:style
public Sub getVBindStyle() As String
Return mVBindStyle
End Sub

'set v-else
public Sub setVElse(varVElse As String)
AddAttr("v-else", varVElse)
mVElse = varVElse
End Sub

'get v-else
public Sub getVElse() As String
Return mVElse
End Sub

'set v-else-if
public Sub setVElseIf(varVElseIf As String)
AddAttr("v-else-if", varVElseIf)
mVElseIf = varVElseIf
End Sub

'get v-else-if
public Sub getVElseIf() As String
Return mVElseIf
End Sub

'set v-for
public Sub setVFor(varVFor As String)
AddAttr("v-for", varVFor)
mVFor = varVFor
End Sub

'get v-for
public Sub getVFor() As String
Return mVFor
End Sub

'set v-html
public Sub setVHtml(varVHtml As String)
AddAttr("v-html", varVHtml)
mVHtml = varVHtml
End Sub

'get v-html
public Sub getVHtml() As String
Return mVHtml
End Sub

'set v-if
public Sub setVIf(varVIf As String)
AddAttr("v-if", varVIf)
mVIf = varVIf
End Sub

'get v-if
public Sub getVIf() As String
Return mVIf
End Sub

'set v-model
public Sub setVModel(varVModel As String)
AddAttr("v-model", varVModel)
mVModel = varVModel
End Sub

'get v-model
public Sub getVModel() As String
Return mVModel
End Sub

'set v-on
public Sub setVOn(varVOn As String)
AddAttr("v-on", varVOn)
mVOn = varVOn
End Sub

'get v-on
public Sub getVOn() As String
Return mVOn
End Sub

'set v-show
public Sub setVShow(varVShow As String)
AddAttr("v-show", varVShow)
mVShow = varVShow
End Sub

'get v-show
public Sub getVShow() As String
Return mVShow
End Sub

'set v-text
public Sub setVText(varVText As String)
AddAttr("v-text", varVText)
mVText = varVText
End Sub

'get v-text
public Sub getVText() As String
Return mVText
End Sub

public Sub setValue(varValue As String)
AddAttr("value", varValue)
mValue = varValue
End Sub

public Sub getValue() As String
Return mValue
End Sub

public Sub setWeekdayFormat(varWeekdayFormat As String)
AddAttr("weekday-format", varWeekdayFormat)
mWeekdayFormat = varWeekdayFormat
End Sub

public Sub getWeekdayFormat() As String
Return mWeekdayFormat
End Sub

public Sub setWeekdays(varWeekdays As String)
AddAttr("weekdays", varWeekdays)
mWeekdays = varWeekdays
End Sub

public Sub getWeekdays() As String
Return mWeekdays
End Sub

'set null
public Sub setBorderColor(varBorderColor As String)
AddStyle("border-color", varBorderColor)
mBorderColor = varBorderColor
End Sub

'get null
public Sub getBorderColor() As String
Return mBorderColor
End Sub

'set null
public Sub setBorderRadius(varBorderRadius As String)
AddStyle("border-radius", varBorderRadius)
mBorderRadius = varBorderRadius
End Sub

'get null
public Sub getBorderRadius() As String
Return mBorderRadius
End Sub

'set null
public Sub setBorderStyle(varBorderStyle As String)
AddStyle("border-style", varBorderStyle)
mBorderStyle = varBorderStyle
End Sub

'get null
public Sub getBorderStyle() As String
Return mBorderStyle
End Sub

'set null
public Sub setBorderWidth(varBorderWidth As String)
AddStyle("border-width", varBorderWidth)
mBorderWidth = varBorderWidth
End Sub

'get null
public Sub getBorderWidth() As String
Return mBorderWidth
End Sub

'set null
public Sub setMarginBottom(varMarginBottom As String)
AddStyle("margin-bottom", varMarginBottom)
mMarginBottom = varMarginBottom
End Sub

'get null
public Sub getMarginBottom() As String
Return mMarginBottom
End Sub

'set null
public Sub setMarginLeft(varMarginLeft As String)
AddStyle("margin-left", varMarginLeft)
mMarginLeft = varMarginLeft
End Sub

'get null
public Sub getMarginLeft() As String
Return mMarginLeft
End Sub

'set null
public Sub setMarginRight(varMarginRight As String)
AddStyle("margin-right", varMarginRight)
mMarginRight = varMarginRight
End Sub

'get null
public Sub getMarginRight() As String
Return mMarginRight
End Sub

'set null
public Sub setMarginTop(varMarginTop As String)
AddStyle("margin-top", varMarginTop)
mMarginTop = varMarginTop
End Sub

'get null
public Sub getMarginTop() As String
Return mMarginTop
End Sub

'set null
public Sub setPaddingBottom(varPaddingBottom As String)
AddStyle("padding-bottom", varPaddingBottom)
mPaddingBottom = varPaddingBottom
End Sub

'get null
public Sub getPaddingBottom() As String
Return mPaddingBottom
End Sub

'set null
public Sub setPaddingLeft(varPaddingLeft As String)
AddStyle("padding-left", varPaddingLeft)
mPaddingLeft = varPaddingLeft
End Sub

'get null
public Sub getPaddingLeft() As String
Return mPaddingLeft
End Sub

'set null
public Sub setPaddingRight(varPaddingRight As String)
AddStyle("padding-right", varPaddingRight)
mPaddingRight = varPaddingRight
End Sub

'get null
public Sub getPaddingRight() As String
Return mPaddingRight
End Sub

'set null
public Sub setPaddingTop(varPaddingTop As String)
AddStyle("padding-top", varPaddingTop)
mPaddingTop = varPaddingTop
End Sub

'get null
public Sub getPaddingTop() As String
Return mPaddingTop
End Sub


'add a child component
Sub AddChild(child As String)
sbText.Append(child)
End Sub

'set on Input event, updates the master events records
Sub SetOnInput()
Dim sName As String = $"${mEventName}_Input"$
sName = sName.tolowercase
If SubExists(mCallBack, sName) = False Then Return
If BANano.IsUndefined(eOnInput) Or BANano.IsNull(eOnInput) Then eOnInput = ""
Dim sCode As String = $"${sName}(${eOnInput})"$
AddAttr("v-on:input", sCode)
'arguments for the event
Dim argument As Object 'ignore
Dim cb As BANanoObject = BANano.CallBack(mCallBack, sName, Array(argument As Object))
methods.Put(sName, cb)
End Sub

Sub SetOnInputE(sInput As String)
eOnInput = sInput
End Sub

